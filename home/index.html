<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>Encryption</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:title" content="" />
  <meta property="og:type" content="" />
  <meta property="og:url" content="" />
  <meta property="og:image" content="" />


  <link href="bootstrap.min.css" rel="stylesheet">

  <meta name="theme-color" content="#fafafa">

  <style>
    textarea {
      overflow: auto;
    }

    textarea::-webkit-scrollbar {
      display: none;
    }
  </style>
</head>

<body class="container py-3">
  <div class="row">
    <div class="col-md-12 mb-4">
      <div class="text-bg-danger p-3">
        <p>确保密码只存在记忆中,不在任何地方书写密码</p>
        禁止使用国产浏览器和国产输入法,会被监听输入,特别是密码,请使用 Chrome 或 Safari
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 mb-4">
      <label for="encrypted-text" class="form-label">密文</label>
      <textarea class="form-control" id="encrypted-text" rows="3" placeholder="输入密文" autocomplete="off"></textarea>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 mb-4">
      <label for="password" class="form-label">密码</label>
      <input type="password" name="disautocomplete" style="display: none;">
      <input type="password" class="form-control" id="password" placeholder="输入密码" autocomplete="new-password">
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 mb-4">
      <div class="d-grid gap-2 d-md-flex justify-content-md-end">
        <button id="decrypt-button" type="button" class="btn btn-danger">解密</button>
        <button id="encrypt-button" type="button" class="btn btn-success">加密</button>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12 mb-4">
      <label for="decrypted-text" class="form-label">明文</label>
      <textarea class="form-control" id="decrypted-text" rows="120" placeholder="输入明文" autocomplete="off"></textarea>
    </div>
  </div>



  <script src="jquery-3.7.1.min.js"></script>
  <script src="crypto-js.min.js"></script>
  <script>
    var words = "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";
    $("#encrypted-text").val(words);
  </script>
  <script>
    $(document).ready(function () {
      $('#encrypt-button').on('click', function () {
        try {
          const decryptedText = $('#decrypted-text').val();
          const password = $('#password').val();

          if (decryptedText === "" || password === "") {
            alert("Please enter decrypted and password.");
            return;
          }

          const salt = CryptoJS.lib.WordArray.random(128 / 8);
          const iterations = 50000;
          const keySize = 256 / 32;

          const key = CryptoJS.PBKDF2(password, salt, {
            keySize: keySize,
            iterations: iterations,
          });

          const iv = CryptoJS.lib.WordArray.random(128 / 8);
          const encrypted = CryptoJS.AES.encrypt(decryptedText, key, { iv: iv });

          // Concatenate salt, IV, and ciphertext
          const encryptedData = salt.concat(iv).concat(encrypted.ciphertext);
          const encryptedText = CryptoJS.enc.Base64.stringify(encryptedData);

          $('#encrypted-text').val(encryptedText);
          $('#decrypted-text').val("");

        } catch (error) {
          alert("error");
        }
      });

      $('#decrypt-button').on('click', function () {
        try {
          const encryptedText = $('#encrypted-text').val();
          const password = $('#password').val();

          if (encryptedText === "" || password === "") {
            alert("Please enter encrypted text and password.");
            return;
          }

          const iterations = 50000;
          const keySize = 256 / 32;

          const encryptedData = CryptoJS.enc.Base64.parse(encryptedText);

          // Extract salt and IV
          const salt = CryptoJS.lib.WordArray.create(encryptedData.words.slice(0, 128 / 32));
          const iv = CryptoJS.lib.WordArray.create(encryptedData.words.slice(128 / 32, 256 / 32));

          const key = CryptoJS.PBKDF2(password, salt, {
            keySize: keySize,
            iterations: iterations,
          });

          // Extract ciphertext
          const ciphertext = CryptoJS.lib.WordArray.create(encryptedData.words.slice(256 / 32));

          const decrypted = CryptoJS.AES.decrypt({ ciphertext: ciphertext }, key, { iv: iv });
          const decryptedText = CryptoJS.enc.Utf8.stringify(decrypted);

          $('#decrypted-text').val(decryptedText);
          $('#encrypted-text').val("");

          $("#decrypted-text").trigger("input");

        } catch (error) {
          alert("error");
        }
      });
    });
  </script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-890HP5PW85"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-890HP5PW85');
  </script>
</body>

</html>